Final Version of the codes and simulink file
